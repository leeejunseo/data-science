# 🚀 미사일 탄도 시뮬레이션 & 분류 게임 - 실행 가이드

## 📋 목차
1. [시스템 요구사항](#시스템-요구사항)
2. [빠른 시작 (게임 실행)](#빠른-시작-게임-실행)
3. [개별 기능 실행](#개별-기능-실행)
4. [문제 해결](#문제-해결)

---

## 시스템 요구사항

### 필수 소프트웨어
- **Python 3.8 이상** (3.10 권장)
- **Node.js 16 이상** (프론트엔드용)
- **Git** (선택사항)

### Python 패키지 설치
```bash
cd final
pip install -r requirements.txt
```

**주요 패키지:**
- `numpy`, `scipy` - 수치 계산
- `matplotlib` - 시각화
- `scikit-learn` - 머신러닝
- `flask`, `flask-cors` - 백엔드 API

### Node.js 패키지 설치 (프론트엔드)
```bash
cd lastpang
npm install
```

---

## 빠른 시작 (게임 실행)

### 🎮 방법 1: 원클릭 실행 (권장)

프로젝트 루트 디렉토리에서:
```bash
run_game.bat
```

**자동으로 실행되는 것:**
1. Python 백엔드 서버 (포트 5000)
2. React 프론트엔드 (포트 3000)
3. 브라우저 자동 오픈 (`http://localhost:3000`)

**게임 방법:**
1. "시뮬레이션 시작" 버튼 클릭
2. 미사일 발사 애니메이션 관찰
3. 착탄 후 "분석하기" 버튼 활성화
4. ML 분석 결과 확인 (특징 중요도, 트리 투표, 확률 분포)
5. 미사일 종류 맞추기!

---

### 🎮 방법 2: 수동 실행

#### 1단계: 백엔드 서버 시작
```bash
cd final
python game_launcher.py --port 5000
```

**확인 메시지:**
```
✅ ML 모델 로드 성공
   - 모델: RandomForest (100 estimators)
   - 특징 수: 15
   - 클래스: ['KN-23', 'Nodong', 'SCUD-B']

🚀 게임 서버 시작
   포트: 5000
   URL: http://localhost:5000
```

#### 2단계: 프론트엔드 시작 (새 터미널)
```bash
cd lastpang
npm start
```

**자동으로 브라우저가 열립니다:** `http://localhost:3000`

---

## 개별 기능 실행

### 1️⃣ 미사일 시뮬레이션 실행

**단일 미사일 시뮬레이션 + 시각화:**
```bash
cd final
python main_visualization.py
```

**출력:**
- `outputs/trajectories/*.npz` - 궤적 데이터
- `results_6dof/*.png` - 12채널 시각화 그래프

**시각화 내용:**
- 3D 궤적
- 속도/고도/마하수 프로파일
- 오일러각/각속도
- 받음각/옆미끄럼각
- 위상 평면 (alpha-q)

---

### 2️⃣ ML 데이터셋 생성

**대량 시뮬레이션 (1500개 샘플):**
```bash
cd final
python signature_generator.py
```

**생성되는 파일:**
- `signature_dataset/dataset_large.npz` - 학습 데이터 (1500×15)
- 각 미사일당 500개 샘플 (다양한 발사각/방위각)

**소요 시간:** 약 30-60분 (CPU 성능에 따라)

---

### 3️⃣ ML 모델 학습

**RandomForest 모델 학습:**
```bash
cd final
python train_large.py
```

**출력:**
```
데이터셋 로드: 1500 samples, 15 features
학습 시작...
학습 완료!

=== 모델 성능 ===
정확도: 0.9867
Precision: 0.9867
Recall: 0.9867
F1-Score: 0.9867

모델 저장: signature_dataset/model_rf.joblib
스케일러 저장: signature_dataset/scaler.joblib
```

**생성되는 파일:**
- `signature_dataset/model_rf.joblib` - 학습된 모델
- `signature_dataset/scaler.joblib` - 특징 정규화 스케일러

---

### 4️⃣ 모델 평가 (발사각 그룹 분리)

**일반화 성능 검증:**
```bash
cd final
python eval_by_angle.py
```

**출력:**
```
=== 발사각 그룹 분리 평가 ===
Train: [15°-45°, 60°-75°]
Test:  [45°-60°]

정확도: 1.0000
Precision: 1.0000
Recall: 1.0000
F1-Score: 1.0000

혼동 행렬:
           SCUD-B  Nodong  KN-23
SCUD-B        100       0      0
Nodong          0     100      0
KN-23           0       0    100
```

**목적:** 학습하지 않은 발사각 범위에서도 정확히 분류하는지 검증

---

### 5️⃣ NPZ 파일 뷰어

**궤적 데이터 확인:**
```bash
cd final
python view_npz.py outputs/trajectories/SCUD-B__elev45.0__azi90.0__seed1234__20251225_120000.npz
```

**출력:**
```
=== NPZ 파일 정보 ===
파일: SCUD-B__elev45.0__azi90.0__seed1234__20251225_120000.npz
미사일: SCUD-B
발사각: 45.0°
방위각: 90.0°

=== 궤적 통계 ===
비행 시간: 287.3 s
최대 고도: 85.2 km
사거리: 298.5 km
최대 속도: 1623.4 m/s (Mach 4.8)
```

---

## 문제 해결

### ❌ 문제 1: 백엔드가 시작되지 않음

**증상:**
```
ModuleNotFoundError: No module named 'flask'
```

**해결:**
```bash
cd final
pip install -r requirements.txt
```

---

### ❌ 문제 2: 프론트엔드가 시작되지 않음

**증상:**
```
'react-scripts' is not recognized
```

**해결:**
```bash
cd lastpang
npm install
npm start
```

---

### ❌ 문제 3: 포트 충돌

**증상:**
```
Address already in use: 5000
```

**해결 1: 다른 포트 사용**
```bash
cd final
python game_launcher.py --port 5001
```

**해결 2: 기존 프로세스 종료**
```bash
# Windows
netstat -ano | findstr :5000
taskkill /PID <PID> /F
```

---

### ❌ 문제 4: ML 모델 파일 없음

**증상:**
```
❌ ML 모델 로드 실패: model_rf.joblib not found
```

**해결:**
```bash
cd final
python train_large.py  # 모델 학습
```

또는 기존 모델 사용:
```bash
# trained_models/ 폴더에 백업 모델 있음
cp trained_models/rf_model.pkl signature_dataset/model_rf.joblib
cp trained_models/scaler.pkl signature_dataset/scaler.joblib
```

---

### ❌ 문제 5: 시뮬레이션이 너무 느림

**증상:**
- `signature_generator.py`가 1시간 이상 소요

**해결:**
```python
# signature_generator.py 수정
N_SAMPLES_PER_MISSILE = 100  # 기본값 500 → 100으로 감소
```

또는 기존 데이터셋 사용:
```bash
# signature_dataset/dataset_large.npz 이미 존재하면 재생성 불필요
```

---

### ❌ 문제 6: 게임에서 "분석하기" 버튼이 안 보임

**증상:**
- 미사일 발사 후 버튼이 나타나지 않음

**원인:**
- UI 수정으로 착탄 후에만 버튼 활성화됨

**확인:**
- 미사일 애니메이션이 완전히 끝날 때까지 대기 (약 5-10초)
- "비행 중..." 버튼이 "분석하기"로 변경되는지 확인

---

## 📊 프로젝트 구조 요약

```
data-science/
├── final/                    # 🎯 메인 실행 폴더
│   ├── game_launcher.py      # 백엔드 API 서버
│   ├── main_visualization.py # 시뮬레이션 + 시각화
│   ├── signature_generator.py # 데이터셋 생성
│   ├── train_large.py        # 모델 학습
│   ├── eval_by_angle.py      # 모델 평가
│   ├── requirements.txt      # Python 의존성
│   └── signature_dataset/    # ML 모델 & 데이터
│
├── lastpang/                 # 🎨 React 프론트엔드
│   ├── src/GameApp.js        # 메인 UI
│   └── package.json          # Node.js 의존성
│
└── run_game.bat              # 🚀 원클릭 실행 스크립트
```

---

## 🎯 주요 기능 요약

| 기능 | 명령어 | 출력 |
|------|--------|------|
| **게임 실행** | `run_game.bat` | 브라우저 게임 UI |
| **시뮬레이션** | `python main_visualization.py` | NPZ + PNG |
| **데이터 생성** | `python signature_generator.py` | dataset_large.npz |
| **모델 학습** | `python train_large.py` | model_rf.joblib |
| **모델 평가** | `python eval_by_angle.py` | 성능 리포트 |

---

## 📞 추가 도움말

### 상세 문서
- `PROJECT_STRUCTURE.md` - 프로젝트 구조 설명
- `final/README.md` - 기술 문서
- `TROUBLESHOOTING.md` - 문제 해결 가이드

### 로그 확인
- 백엔드 로그: 터미널 출력 확인
- 프론트엔드 로그: 브라우저 개발자 도구 (F12)

### 성능 최적화
- Python: `python -O` (최적화 모드)
- Node.js: `npm run build` (프로덕션 빌드)

---

**마지막 업데이트:** 2024-12-25  
**프로젝트:** 탄도미사일 6DOF 시뮬레이션 & ML 분류  
**팀:** 데이터과학 2팀 (박윤준, 정연우, 김찬진, 이준서)
